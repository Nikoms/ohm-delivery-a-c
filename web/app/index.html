<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="lib/angular/angular.js"></script>
    <script src="./main.js"></script>
    <link rel="stylesheet" type="text/css" href="normalize.css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <title>Ohm Delivery</title>
  </head>
  <body>
    <div ng-app="ohm-delivery" ng-controller="tracking" class="container">
      <div class="banner">
        <h1>Ohm Delivery</h1>
        <h2>Get shocked by the power</h2>
      </div>
      <div class="tracking__query">
        <form ng-submit="sendData()">
          <div>
            <input
              id="tracking"
              type="text"
              autofocus
              ng-model="trackingId"
              placeholder="Enter your tracking id"
            />
          </div>
          <div>
            <button id="formBtn" type="submit">Submit</button>
          </div>
        </form>
      </div>

      <div ng-if="errorMessage" class="banner banner--danger">
        {{errorMessage}}
      </div>

      <div ng-if="resistance" class="tracking__result">
        <div ng-if="resistance.history.slice(-1)[0].rejectionReason" class="banner banner--warning">
          {{resistance.history.slice(-1)[0].rejectionReason}}
        </div>
        <div class="result__history">
          <div ng-repeat="item in resistance.history" class="history__item">
            <div class="history__content">
              {{item.state}}
            </div>
            <div class="history__arrow"></div>
          </div>

          <div ng-if="resistance.isDriver && resistance.history.slice(-1)[0].state == 'IN_DELIVERY'">
            <div class="history__item history__item--clickable history__item--success" ng-click="changeStatus('DELIVERED')">
              <div class="history__content">
                DELIVERED
              </div>
              <div class="history__arrow"></div>
            </div>
            <div style="height: 1rem"></div>
            <div class="history__item history__item--clickable history__item--danger" ng-click="changeStatus('REFUSED')">
              <div class="history__content">
                REFUSED
              </div>
              <div class="history__arrow"></div>
            </div>
          </div>
        </div>
        <div class="result__customer">
          <dl>
            <dt>Name</dt>
            <dd>{{resistance.client.name}}</dd>
            <dt>Address</dt>
            <dd>{{resistance.client.address}}</dd>
          </dl>
        </div>
        <div class="result__details">
          <h2>
            Resistance: {{resistance.description.volts / resistance.description.amperes}} Ohm
          </h2>
        </div>
      </div>
    </div>
  </body>
</html>
